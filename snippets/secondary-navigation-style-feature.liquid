{%- comment -%}
  Style/Feature Dropdown for Secondary Navigation
  Three-column layout: styles list (left), image (center), description + CTA (right)
{%- endcomment -%}

<div class="secondary-navigation-style-feature">
  <div class="secondary-navigation-style-feature__grid">
    {%- comment -%} Left: Styles List {%- endcomment -%}
    {%- if mega_menu_block.settings.style_list != blank -%}
      {%- assign collection_url = mega_menu_block.settings.style_feature_button_url | default: '' -%}
      {%- assign styles = mega_menu_block.settings.style_list | newline_to_br | split: '<br />' -%}
      <ul class="secondary-navigation-style-feature__styles-list">
        {%- for style in styles -%}
          {%- assign style_trimmed = style | strip -%}
          {%- if style_trimmed != blank -%}
            {%- assign style_parts = style_trimmed | split: '|' -%}
            {%- assign style_title = style_parts[0] | strip -%}
            {%- assign style_underline = style_parts[1] | strip | default: '' -%}
            {%- comment -%} Build collection URL with filter {%- endcomment -%}
            {%- if collection_url != blank -%}
              {%- assign style_filter_value = style_title | url_param_escape -%}
              {%- if collection_url contains '?' -%}
                {%- assign style_link_url = collection_url | append: '&filter.p.m.custom.collection_by_style=' | append: style_filter_value -%}
              {%- else -%}
                {%- assign style_link_url = collection_url | append: '?filter.p.m.custom.collection_by_style=' | append: style_filter_value -%}
              {%- endif -%}
            {%- else -%}
              {%- assign style_link_url = '' -%}
            {%- endif -%}
            <li class="secondary-navigation-style-feature__style-item">
              {%- if style_link_url != blank -%}
                <a href="{{ style_link_url }}" class="secondary-navigation-style-feature__style-link {% if style_underline == 'underline' %}secondary-navigation-style-feature__style-link--underlined{% endif %}">
                  {{- style_title -}}
                </a>
              {%- else -%}
                <span class="secondary-navigation-style-feature__style-link {% if style_underline == 'underline' %}secondary-navigation-style-feature__style-link--underlined{% endif %}">
                  {{- style_title -}}
                </span>
              {%- endif -%}
            </li>
          {%- endif -%}
        {%- endfor -%}
      </ul>
    {%- endif -%}

    {%- comment -%} Center: Image {%- endcomment -%}
    <div class="secondary-navigation-style-feature__image-wrapper">
      {%- if mega_menu_block.settings.style_feature_image != blank -%}
        {{- mega_menu_block.settings.style_feature_image | image_url: width: 1200 | image_tag: loading: 'lazy', class: 'secondary-navigation-style-feature__image', alt: 'Style feature' -}}
      {%- else -%}
        <div style="min-height: 200px; background-color: #f5f5f5; border-radius: 10px;"></div>
      {%- endif -%}
    </div>

    {%- comment -%} Right: Description + CTA {%- endcomment -%}
    <div class="secondary-navigation-style-feature__content">
      {%- if mega_menu_block.settings.style_feature_description != blank -%}
        <p class="secondary-navigation-style-feature__description">{{ mega_menu_block.settings.style_feature_description }}</p>
      {%- endif -%}

      {%- if mega_menu_block.settings.style_feature_button_text != blank and mega_menu_block.settings.style_feature_button_url != blank -%}
        <a href="{{ mega_menu_block.settings.style_feature_button_url }}" class="button secondary-navigation-style-feature__button" style="{% if mega_menu_block.settings.style_feature_button_background != blank %}background-color: {{ mega_menu_block.settings.style_feature_button_background }};{% endif %}{% if mega_menu_block.settings.style_feature_button_text_color != blank %}color: {{ mega_menu_block.settings.style_feature_button_text_color }};{% endif %}">
          {{- mega_menu_block.settings.style_feature_button_text -}}
        </a>
      {%- endif -%}
    </div>
  </div>
</div>

